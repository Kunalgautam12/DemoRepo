This is in R3 branch.
